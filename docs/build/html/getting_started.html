
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Getting Started &#8212; Geometricus 0.0.1-dev documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="API Reference" href="api/modules.html" />
    <link rel="prev" title="Installing Geometricus" href="install.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="index.html">
    <img class="logo" src="_static/geometricus_logo.png" alt="Logo"/>
    
  </a>
</p>



<p class="blurb">Fast, structure-based, alignment-free protein embedding</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=TurtleTools&repo=geometricus&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="install.html">Installing Geometricus</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#structural-fragmentation">Structural fragmentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#generating-an-embedding-from-structural-fragments">Generating an Embedding from Structural Fragments</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#embedding-for-dimensionality-reduction">Embedding for Dimensionality Reduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#embedding-for-supervised-learning">Embedding for Supervised Learning</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#finding-predictive-residues-and-structural-fragments">Finding predictive residues and structural fragments</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api/modules.html">API Reference</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="install.html" title="previous chapter">Installing Geometricus</a></li>
      <li>Next: <a href="api/modules.html" title="next chapter">API Reference</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
</pre></div>
</div>
<div class="section" id="getting-started">
<h1>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h1>
<p>Let’s walk through an example application of Geometricus in machine
learning using a dataset of human MAP kinases, divided into three
classes - JNK, Erk, and p38 kinases. This dataset was generated from the
<a class="reference external" href="https://klifs.vu-compmedchem.nl/index.php">Kinase-Ligand Interaction Fingerprints and Structures database
(KLIFS)</a> (Raw table
<a class="reference external" href="../../example_data/MAPK_KLIFS.tsv">here</a>).</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pnd</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">time</span>

<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://raw.githubusercontent.com/TurtleTools/geometricus/master/example_data/MAPK_KLIFS.tsv&quot;</span>
<span class="n">mapk_df</span> <span class="o">=</span> <span class="n">pnd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">mapk_pdb_id_to_class</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">pdb_id</span><span class="p">,</span> <span class="n">chain</span><span class="p">,</span> <span class="n">class_name</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">mapk_df</span><span class="p">[</span><span class="s2">&quot;PDB&quot;</span><span class="p">],</span> <span class="n">mapk_df</span><span class="p">[</span><span class="s2">&quot;CHAIN&quot;</span><span class="p">],</span> <span class="n">mapk_df</span><span class="p">[</span><span class="s2">&quot;CLASS&quot;</span><span class="p">])):</span>
    <span class="n">mapk_pdb_id_to_class</span><span class="p">[(</span><span class="n">pdb_id</span><span class="p">,</span> <span class="n">chain</span><span class="p">)]</span> <span class="o">=</span> <span class="n">class_name</span>
<span class="nb">len</span><span class="p">(</span><span class="n">mapk_pdb_id_to_class</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">527</span>
</pre></div>
</div>
<p>So now we have a list of (PDB ID, chain) pairs, each associated with a
class</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X_names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">mapk_pdb_id_to_class</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
<span class="n">class_mapping</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;JNK&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s2">&quot;Erk&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;p38&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>
<span class="n">y</span> <span class="o">=</span> <span class="p">[</span><span class="n">class_mapping</span><span class="p">[</span><span class="n">mapk_pdb_id_to_class</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">X_names</span><span class="p">]</span>
</pre></div>
</div>
<div class="section" id="structural-fragmentation">
<h2>Structural fragmentation<a class="headerlink" href="#structural-fragmentation" title="Permalink to this headline">¶</a></h2>
<p>We consider two different ways of dividing a protein with <span class="math notranslate nohighlight">\(l\)</span>
residues into structural fragments, a <span class="math notranslate nohighlight">\(k\)</span>-mer-based approach and a
radius-based approach. For each structural fragment, multiple rotation
and translation-invariant moments can be calculated. While the
<span class="math notranslate nohighlight">\(k\)</span>-mer based approach is effective in describing structural
fragments that are sequential in nature, such as <span class="math notranslate nohighlight">\(\alpha\)</span>-helices
and loops, the radius-based approach can capture long-range structural
contacts as seen in <span class="math notranslate nohighlight">\(\beta\)</span>-sheets, as well as distinct
interaction patterns in space, as found in enzyme active sites.</p>
<p>Below we fetch and parse each protein as a ProDy AtomGroup object. This
takes a while (around 15 mins) since it downloads via FTP from RCSB.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">prody</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
<span class="n">pdbs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">pdb_id</span><span class="p">,</span> <span class="n">chain</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">X_names</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">50</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> proteins fetched in </span><span class="si">{</span><span class="p">(</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
    <span class="n">pdbs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">parsePDB</span><span class="p">(</span><span class="n">pdb_id</span><span class="p">,</span> <span class="n">chain</span><span class="o">=</span><span class="n">chain</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">50</span> <span class="n">proteins</span> <span class="n">fetched</span> <span class="ow">in</span> <span class="mf">96.46</span> <span class="n">seconds</span>
<span class="mi">100</span> <span class="n">proteins</span> <span class="n">fetched</span> <span class="ow">in</span> <span class="mf">194.62</span> <span class="n">seconds</span>
<span class="mi">150</span> <span class="n">proteins</span> <span class="n">fetched</span> <span class="ow">in</span> <span class="mf">281.02</span> <span class="n">seconds</span>
<span class="mi">200</span> <span class="n">proteins</span> <span class="n">fetched</span> <span class="ow">in</span> <span class="mf">365.41</span> <span class="n">seconds</span>
<span class="mi">250</span> <span class="n">proteins</span> <span class="n">fetched</span> <span class="ow">in</span> <span class="mf">448.01</span> <span class="n">seconds</span>
<span class="mi">300</span> <span class="n">proteins</span> <span class="n">fetched</span> <span class="ow">in</span> <span class="mf">534.71</span> <span class="n">seconds</span>
<span class="mi">350</span> <span class="n">proteins</span> <span class="n">fetched</span> <span class="ow">in</span> <span class="mf">613.16</span> <span class="n">seconds</span>
<span class="mi">400</span> <span class="n">proteins</span> <span class="n">fetched</span> <span class="ow">in</span> <span class="mf">692.71</span> <span class="n">seconds</span>
<span class="mi">450</span> <span class="n">proteins</span> <span class="n">fetched</span> <span class="ow">in</span> <span class="mf">777.41</span> <span class="n">seconds</span>
<span class="mi">500</span> <span class="n">proteins</span> <span class="n">fetched</span> <span class="ow">in</span> <span class="mf">861.82</span> <span class="n">seconds</span>
</pre></div>
</div>
<p>Moment invariants can be calculated using the
<code class="docutils literal notranslate"><span class="pre">geometricus.MomentInvariants</span></code> class. This class has many
constructors, such as the <code class="docutils literal notranslate"><span class="pre">from_prody_atomgroup</span></code> below. This can be
replaced by <code class="docutils literal notranslate"><span class="pre">from_pdb_file</span></code> to load a protein from a file or even
<code class="docutils literal notranslate"><span class="pre">from_pdb_id</span></code> to download from RCSB via FTP.</p>
<p>This is the point where you decide the type and size of structural
fragmentation to use. The options are:</p>
<ul class="simple">
<li><p>KMER - each residue is taken as the center of a kmer of length
<code class="docutils literal notranslate"><span class="pre">split_size</span></code>, ends are included but shorter</p></li>
<li><p>RADIUS - overlapping spheres of radius <code class="docutils literal notranslate"><span class="pre">split_size</span></code></p></li>
<li><p>RADIUS_UPSAMPLE - upsamples backbone atoms before taking overlapping
spheres.</p></li>
<li><p>KMER_CUT - same as kmer but ends are not included, only fragments of
length <code class="docutils literal notranslate"><span class="pre">split_size</span></code> are kept</p></li>
<li><p>ALLMER - adds kmers of different lengths (<code class="docutils literal notranslate"><span class="pre">split_size</span> <span class="pre">-</span> <span class="pre">5</span></code> to
<code class="docutils literal notranslate"><span class="pre">split_size</span> <span class="pre">+</span> <span class="pre">5</span></code>) to take into account deletions/insertions that
don’t change the shape</p></li>
</ul>
<p>Below we use <code class="docutils literal notranslate"><span class="pre">SplitType.KMER</span></code> with a <code class="docutils literal notranslate"><span class="pre">split_size</span></code> (i.e. kmer size)
of 16 and <code class="docutils literal notranslate"><span class="pre">SplitType.RADIUS</span></code> with a <code class="docutils literal notranslate"><span class="pre">split_size</span></code> (i.e. radius) of
10.</p>
<p><code class="docutils literal notranslate"><span class="pre">geometricus.MomentType</span></code> lists the available moment invariants. By
default <span class="math notranslate nohighlight">\(O_3\)</span>, <span class="math notranslate nohighlight">\(O_4\)</span>, <span class="math notranslate nohighlight">\(O_5\)</span>, and <span class="math notranslate nohighlight">\(F\)</span> are
calculated. This can be changed using the <code class="docutils literal notranslate"><span class="pre">moment_types</span></code> argument in
any of the <code class="docutils literal notranslate"><span class="pre">MomentInvariants</span></code> constructors.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">geometricus</span> <span class="kn">import</span> <span class="n">MomentInvariants</span><span class="p">,</span> <span class="n">SplitType</span>

<span class="n">invariants_kmer</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">invariants_radius</span> <span class="o">=</span> <span class="p">[]</span>

<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">X_names</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">50</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2"> proteins in </span><span class="si">{</span><span class="p">(</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>
    <span class="n">invariants_kmer</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">MomentInvariants</span><span class="o">.</span><span class="n">from_prody_atomgroup</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">pdbs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">split_type</span><span class="o">=</span><span class="n">SplitType</span><span class="o">.</span><span class="n">KMER</span><span class="p">,</span> <span class="n">split_size</span><span class="o">=</span><span class="mi">16</span><span class="p">))</span>
    <span class="n">invariants_radius</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">MomentInvariants</span><span class="o">.</span><span class="n">from_prody_atomgroup</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">pdbs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">split_type</span><span class="o">=</span><span class="n">SplitType</span><span class="o">.</span><span class="n">RADIUS</span><span class="p">,</span> <span class="n">split_size</span><span class="o">=</span><span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">50</span> <span class="n">proteins</span> <span class="ow">in</span> <span class="mf">3.42</span> <span class="n">seconds</span>
<span class="mi">100</span> <span class="n">proteins</span> <span class="ow">in</span> <span class="mf">8.67</span> <span class="n">seconds</span>
<span class="mi">150</span> <span class="n">proteins</span> <span class="ow">in</span> <span class="mf">15.67</span> <span class="n">seconds</span>
<span class="mi">200</span> <span class="n">proteins</span> <span class="ow">in</span> <span class="mf">20.08</span> <span class="n">seconds</span>
<span class="mi">250</span> <span class="n">proteins</span> <span class="ow">in</span> <span class="mf">25.12</span> <span class="n">seconds</span>
<span class="mi">300</span> <span class="n">proteins</span> <span class="ow">in</span> <span class="mf">29.88</span> <span class="n">seconds</span>
<span class="mi">350</span> <span class="n">proteins</span> <span class="ow">in</span> <span class="mf">33.77</span> <span class="n">seconds</span>
<span class="mi">400</span> <span class="n">proteins</span> <span class="ow">in</span> <span class="mf">38.55</span> <span class="n">seconds</span>
<span class="mi">450</span> <span class="n">proteins</span> <span class="ow">in</span> <span class="mf">43.29</span> <span class="n">seconds</span>
<span class="mi">500</span> <span class="n">proteins</span> <span class="ow">in</span> <span class="mf">45.82</span> <span class="n">seconds</span>
</pre></div>
</div>
</div>
<div class="section" id="generating-an-embedding-from-structural-fragments">
<h2>Generating an Embedding from Structural Fragments<a class="headerlink" href="#generating-an-embedding-from-structural-fragments" title="Permalink to this headline">¶</a></h2>
<p>Moment invariants are discretized into shape-mers, using a
<strong>resolution</strong> parameter which controls how coarse or fine-grained this
discretization is. A count vector of shape-mers is calculated for each
protein with each element recording the number of times the
corresponding shape-mer appears in that protein. The resolution
parameter can be optimized to the task at hand. Generally, more
divergent proteins would require a lower resolution while highly similar
proteins would need higher resolutions to differentiate them. For the
MAP kinases, we use a relatively high resolution of 2.</p>
<p>Depending on the use-case you may want to embed all proteins at once, as
demonstrated below, or separate train and test proteins as demonstrated
in the Supervised Learning section.</p>
<div class="section" id="embedding-for-dimensionality-reduction">
<h3>Embedding for Dimensionality Reduction<a class="headerlink" href="#embedding-for-dimensionality-reduction" title="Permalink to this headline">¶</a></h3>
<p>Embeddings across all proteins can be used for dimensionality reduction
and visualization.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">umap</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">geometricus</span> <span class="kn">import</span> <span class="n">GeometricusEmbedding</span>

<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="p">()</span>
<span class="n">kmer_embedder</span> <span class="o">=</span> <span class="n">GeometricusEmbedding</span><span class="o">.</span><span class="n">from_invariants</span><span class="p">(</span><span class="n">invariants_kmer</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="mf">2.</span><span class="p">)</span>
<span class="n">radius_embedder</span> <span class="o">=</span> <span class="n">GeometricusEmbedding</span><span class="o">.</span><span class="n">from_invariants</span><span class="p">(</span><span class="n">invariants_radius</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="mf">2.</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Generated embeddings in </span><span class="si">{</span><span class="p">(</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">)</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">)</span>

<span class="n">reducer</span> <span class="o">=</span> <span class="n">umap</span><span class="o">.</span><span class="n">UMAP</span><span class="p">(</span><span class="n">metric</span><span class="o">=</span><span class="s2">&quot;cosine&quot;</span><span class="p">,</span> <span class="n">n_components</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">reduced</span> <span class="o">=</span> <span class="n">reducer</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">kmer_embedder</span><span class="o">.</span><span class="n">embedding</span><span class="p">,</span> <span class="n">radius_embedder</span><span class="o">.</span><span class="n">embedding</span><span class="p">)))</span>

<span class="n">class_names</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;JNK&quot;</span><span class="p">,</span> <span class="s2">&quot;Erk&quot;</span><span class="p">,</span> <span class="s2">&quot;p38&quot;</span><span class="p">]</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;red&quot;</span><span class="p">,</span> <span class="s2">&quot;green&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">]</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">==</span> <span class="n">i</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">reduced</span><span class="p">[</span><span class="n">indices</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                <span class="n">reduced</span><span class="p">[</span><span class="n">indices</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                <span class="n">label</span><span class="o">=</span><span class="n">class_names</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s2">&quot;black&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Generated</span> <span class="n">embeddings</span> <span class="ow">in</span> <span class="mf">1.19</span> <span class="n">seconds</span>
</pre></div>
</div>
<img alt="_images/getting_started_11_1.png" src="_images/getting_started_11_1.png" />
</div>
<div class="section" id="embedding-for-supervised-learning">
<h3>Embedding for Supervised Learning<a class="headerlink" href="#embedding-for-supervised-learning" title="Permalink to this headline">¶</a></h3>
<p>Supervised learning, be it classification or regression, requires some
form of training and test set separation. Below, the shape-mers used for
embedding are calculated from the training set (using the kmer approach)
and only those shape-mers are counted in the test proteins.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="n">X_train_names</span><span class="p">,</span> <span class="n">X_test_names</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X_names</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>

<span class="n">train_embedder</span> <span class="o">=</span> <span class="n">GeometricusEmbedding</span><span class="o">.</span><span class="n">from_invariants</span><span class="p">(</span><span class="n">invariants_kmer</span><span class="p">,</span> <span class="n">resolution</span><span class="o">=</span><span class="mf">2.</span><span class="p">,</span> <span class="n">protein_keys</span><span class="o">=</span><span class="n">X_train_names</span><span class="p">)</span>
<span class="n">test_embedder</span> <span class="o">=</span> <span class="n">train_embedder</span><span class="o">.</span><span class="n">embed</span><span class="p">(</span><span class="n">invariants_kmer</span><span class="p">,</span> <span class="n">X_test_names</span><span class="p">)</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span> <span class="o">=</span> <span class="n">train_embedder</span><span class="o">.</span><span class="n">embedding</span><span class="p">,</span> <span class="n">test_embedder</span><span class="o">.</span><span class="n">embedding</span>
</pre></div>
</div>
<p>For this simple problem, a decision tree classifier is more than enough
to obtain good accuracy.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeClassifier</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">classification_report</span>

<span class="n">clf</span> <span class="o">=</span> <span class="n">DecisionTreeClassifier</span><span class="p">(</span><span class="n">random_state</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span> <span class="n">max_depth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">classification_report</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">class_names</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>              <span class="n">precision</span>    <span class="n">recall</span>  <span class="n">f1</span><span class="o">-</span><span class="n">score</span>   <span class="n">support</span>

         <span class="n">JNK</span>       <span class="mf">0.84</span>      <span class="mf">0.93</span>      <span class="mf">0.89</span>        <span class="mi">29</span>
         <span class="n">Erk</span>       <span class="mf">0.93</span>      <span class="mf">0.89</span>      <span class="mf">0.91</span>        <span class="mi">46</span>
         <span class="n">p38</span>       <span class="mf">0.95</span>      <span class="mf">0.94</span>      <span class="mf">0.95</span>        <span class="mi">84</span>

    <span class="n">accuracy</span>                           <span class="mf">0.92</span>       <span class="mi">159</span>
   <span class="n">macro</span> <span class="n">avg</span>       <span class="mf">0.91</span>      <span class="mf">0.92</span>      <span class="mf">0.91</span>       <span class="mi">159</span>
<span class="n">weighted</span> <span class="n">avg</span>       <span class="mf">0.93</span>      <span class="mf">0.92</span>      <span class="mf">0.92</span>       <span class="mi">159</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="finding-predictive-residues-and-structural-fragments">
<h2>Finding predictive residues and structural fragments<a class="headerlink" href="#finding-predictive-residues-and-structural-fragments" title="Permalink to this headline">¶</a></h2>
<p>Since each shape-mer can be mapped back to the residues it describes,
it’s easy to use Geometricus to determine predictive or functionally
relevant residues and structural regions from a trained predictor (or
from loadings generated from a method such as PCA). Such insights can be
directly be applied to select candidate residues for mutational studies
or used in directed evolution techniques to engineer proteins and
enzymes with desired properties.</p>
<p>By inspecting the decision tree created above, it becomes clear that
some shape-mers are present multiple times across a protein and the
number of times differs across classes.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">plot_tree</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span>
<span class="n">plot_tree</span><span class="p">(</span><span class="n">clf</span><span class="p">,</span> <span class="n">filled</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">feature_names</span><span class="o">=</span><span class="n">train_embedder</span><span class="o">.</span><span class="n">shapemer_keys</span><span class="p">);</span>
</pre></div>
</div>
<img alt="_images/getting_started_17_0.png" src="_images/getting_started_17_0.png" />
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">clf</span><span class="o">.</span><span class="n">feature_importances_</span><span class="p">)</span>
<span class="n">predictive_feature_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">clf</span><span class="o">.</span><span class="n">feature_importances_</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="mi">6</span><span class="p">]</span>
</pre></div>
</div>
<img alt="_images/getting_started_18_0.png" src="_images/getting_started_18_0.png" />
<p>We can map back to the residues described by a shape-mer using the
<code class="docutils literal notranslate"><span class="pre">map_shapemer_to_residues</span></code> function which returns a dictionary mapping
each protein to the corresponding residue indices of the shape-mer
within that protein, if it exists.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">shapemer</span> <span class="o">=</span> <span class="n">train_embedder</span><span class="o">.</span><span class="n">shapemer_keys</span><span class="p">[</span><span class="n">predictive_feature_indices</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">residue_indices_train</span> <span class="o">=</span> <span class="n">train_embedder</span><span class="o">.</span><span class="n">map_shapemer_to_residues</span><span class="p">(</span><span class="n">shapemer</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Shape-mer:&quot;</span><span class="p">,</span> <span class="n">shapemer</span><span class="p">,</span> <span class="s2">&quot;Number of proteins with shape-mer:&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">residue_indices_train</span><span class="p">))</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Residue indices per protein (for 10 proteins):&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">residue_indices_train</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
        <span class="k">break</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">residue_indices_train</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Shape</span><span class="o">-</span><span class="n">mer</span><span class="p">:</span> <span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">34</span><span class="p">)</span> <span class="n">Number</span> <span class="n">of</span> <span class="n">proteins</span> <span class="k">with</span> <span class="n">shape</span><span class="o">-</span><span class="n">mer</span><span class="p">:</span> <span class="mi">507</span>

<span class="n">Residue</span> <span class="n">indices</span> <span class="n">per</span> <span class="n">protein</span> <span class="p">(</span><span class="k">for</span> <span class="mi">10</span> <span class="n">proteins</span><span class="p">):</span>
<span class="p">(</span><span class="s1">&#39;3o2m&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">)</span> <span class="p">{</span><span class="mi">234</span><span class="p">,</span> <span class="mi">235</span><span class="p">,</span> <span class="mi">236</span><span class="p">,</span> <span class="mi">237</span><span class="p">,</span> <span class="mi">238</span><span class="p">,</span> <span class="mi">239</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">241</span><span class="p">,</span> <span class="mi">242</span><span class="p">,</span> <span class="mi">243</span><span class="p">,</span> <span class="mi">244</span><span class="p">,</span> <span class="mi">245</span><span class="p">,</span> <span class="mi">246</span><span class="p">,</span> <span class="mi">247</span><span class="p">,</span> <span class="mi">248</span><span class="p">,</span> <span class="mi">249</span><span class="p">}</span>
<span class="p">(</span><span class="s1">&#39;3o2m&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">)</span> <span class="p">{</span><span class="mi">234</span><span class="p">,</span> <span class="mi">235</span><span class="p">,</span> <span class="mi">236</span><span class="p">,</span> <span class="mi">237</span><span class="p">,</span> <span class="mi">238</span><span class="p">,</span> <span class="mi">239</span><span class="p">,</span> <span class="mi">240</span><span class="p">,</span> <span class="mi">241</span><span class="p">,</span> <span class="mi">242</span><span class="p">,</span> <span class="mi">243</span><span class="p">,</span> <span class="mi">244</span><span class="p">,</span> <span class="mi">245</span><span class="p">,</span> <span class="mi">246</span><span class="p">,</span> <span class="mi">247</span><span class="p">,</span> <span class="mi">248</span><span class="p">,</span> <span class="mi">249</span><span class="p">}</span>
<span class="p">(</span><span class="s1">&#39;4eh8&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">)</span> <span class="p">{</span><span class="mi">231</span><span class="p">,</span> <span class="mi">232</span><span class="p">,</span> <span class="mi">233</span><span class="p">,</span> <span class="mi">234</span><span class="p">,</span> <span class="mi">235</span><span class="p">,</span> <span class="mi">220</span><span class="p">,</span> <span class="mi">221</span><span class="p">,</span> <span class="mi">222</span><span class="p">,</span> <span class="mi">223</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">225</span><span class="p">,</span> <span class="mi">226</span><span class="p">,</span> <span class="mi">227</span><span class="p">,</span> <span class="mi">228</span><span class="p">,</span> <span class="mi">229</span><span class="p">,</span> <span class="mi">230</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span> <span class="mi">107</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">113</span><span class="p">,</span> <span class="mi">114</span><span class="p">,</span> <span class="mi">115</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">117</span><span class="p">,</span> <span class="mi">118</span><span class="p">,</span> <span class="mi">119</span><span class="p">}</span>
<span class="p">(</span><span class="s1">&#39;4eh2&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">)</span> <span class="p">{</span><span class="mi">230</span><span class="p">,</span> <span class="mi">231</span><span class="p">,</span> <span class="mi">232</span><span class="p">,</span> <span class="mi">233</span><span class="p">,</span> <span class="mi">234</span><span class="p">,</span> <span class="mi">235</span><span class="p">,</span> <span class="mi">236</span><span class="p">,</span> <span class="mi">221</span><span class="p">,</span> <span class="mi">222</span><span class="p">,</span> <span class="mi">223</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">225</span><span class="p">,</span> <span class="mi">226</span><span class="p">,</span> <span class="mi">227</span><span class="p">,</span> <span class="mi">228</span><span class="p">,</span> <span class="mi">229</span><span class="p">,</span> <span class="mi">102</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span> <span class="mi">107</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">113</span><span class="p">,</span> <span class="mi">114</span><span class="p">,</span> <span class="mi">115</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">117</span><span class="p">,</span> <span class="mi">118</span><span class="p">,</span> <span class="mi">119</span><span class="p">}</span>
<span class="p">(</span><span class="s1">&#39;4eh7&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">)</span> <span class="p">{</span><span class="mi">224</span><span class="p">,</span> <span class="mi">225</span><span class="p">,</span> <span class="mi">226</span><span class="p">,</span> <span class="mi">227</span><span class="p">,</span> <span class="mi">228</span><span class="p">,</span> <span class="mi">229</span><span class="p">,</span> <span class="mi">230</span><span class="p">,</span> <span class="mi">231</span><span class="p">,</span> <span class="mi">232</span><span class="p">,</span> <span class="mi">233</span><span class="p">,</span> <span class="mi">234</span><span class="p">,</span> <span class="mi">235</span><span class="p">,</span> <span class="mi">236</span><span class="p">,</span> <span class="mi">221</span><span class="p">,</span> <span class="mi">222</span><span class="p">,</span> <span class="mi">223</span><span class="p">}</span>
<span class="p">(</span><span class="s1">&#39;4eh5&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">)</span> <span class="p">{</span><span class="mi">224</span><span class="p">,</span> <span class="mi">225</span><span class="p">,</span> <span class="mi">226</span><span class="p">,</span> <span class="mi">227</span><span class="p">,</span> <span class="mi">228</span><span class="p">,</span> <span class="mi">213</span><span class="p">,</span> <span class="mi">214</span><span class="p">,</span> <span class="mi">215</span><span class="p">,</span> <span class="mi">216</span><span class="p">,</span> <span class="mi">217</span><span class="p">,</span> <span class="mi">218</span><span class="p">,</span> <span class="mi">219</span><span class="p">,</span> <span class="mi">220</span><span class="p">,</span> <span class="mi">221</span><span class="p">,</span> <span class="mi">222</span><span class="p">,</span> <span class="mi">223</span><span class="p">}</span>
<span class="p">(</span><span class="s1">&#39;4dli&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">)</span> <span class="p">{</span><span class="mi">224</span><span class="p">,</span> <span class="mi">225</span><span class="p">,</span> <span class="mi">226</span><span class="p">,</span> <span class="mi">227</span><span class="p">,</span> <span class="mi">228</span><span class="p">,</span> <span class="mi">229</span><span class="p">,</span> <span class="mi">230</span><span class="p">,</span> <span class="mi">231</span><span class="p">,</span> <span class="mi">232</span><span class="p">,</span> <span class="mi">233</span><span class="p">,</span> <span class="mi">218</span><span class="p">,</span> <span class="mi">219</span><span class="p">,</span> <span class="mi">220</span><span class="p">,</span> <span class="mi">221</span><span class="p">,</span> <span class="mi">222</span><span class="p">,</span> <span class="mi">223</span><span class="p">}</span>
<span class="p">(</span><span class="s1">&#39;4eh3&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">)</span> <span class="p">{</span><span class="mi">231</span><span class="p">,</span> <span class="mi">232</span><span class="p">,</span> <span class="mi">233</span><span class="p">,</span> <span class="mi">234</span><span class="p">,</span> <span class="mi">235</span><span class="p">,</span> <span class="mi">236</span><span class="p">,</span> <span class="mi">237</span><span class="p">,</span> <span class="mi">238</span><span class="p">,</span> <span class="mi">223</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">225</span><span class="p">,</span> <span class="mi">226</span><span class="p">,</span> <span class="mi">227</span><span class="p">,</span> <span class="mi">228</span><span class="p">,</span> <span class="mi">229</span><span class="p">,</span> <span class="mi">230</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span> <span class="mi">107</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">113</span><span class="p">,</span> <span class="mi">114</span><span class="p">,</span> <span class="mi">115</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">117</span><span class="p">,</span> <span class="mi">118</span><span class="p">,</span> <span class="mi">119</span><span class="p">}</span>
<span class="p">(</span><span class="s1">&#39;4eh6&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">)</span> <span class="p">{</span><span class="mi">231</span><span class="p">,</span> <span class="mi">232</span><span class="p">,</span> <span class="mi">233</span><span class="p">,</span> <span class="mi">234</span><span class="p">,</span> <span class="mi">163</span><span class="p">,</span> <span class="mi">164</span><span class="p">,</span> <span class="mi">165</span><span class="p">,</span> <span class="mi">166</span><span class="p">,</span> <span class="mi">167</span><span class="p">,</span> <span class="mi">168</span><span class="p">,</span> <span class="mi">169</span><span class="p">,</span> <span class="mi">170</span><span class="p">,</span> <span class="mi">171</span><span class="p">,</span> <span class="mi">172</span><span class="p">,</span> <span class="mi">173</span><span class="p">,</span> <span class="mi">174</span><span class="p">,</span> <span class="mi">175</span><span class="p">,</span> <span class="mi">176</span><span class="p">,</span> <span class="mi">177</span><span class="p">,</span> <span class="mi">178</span><span class="p">,</span> <span class="mi">219</span><span class="p">,</span> <span class="mi">220</span><span class="p">,</span> <span class="mi">221</span><span class="p">,</span> <span class="mi">222</span><span class="p">,</span> <span class="mi">223</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">225</span><span class="p">,</span> <span class="mi">226</span><span class="p">,</span> <span class="mi">227</span><span class="p">,</span> <span class="mi">228</span><span class="p">,</span> <span class="mi">229</span><span class="p">,</span> <span class="mi">230</span><span class="p">,</span> <span class="mi">103</span><span class="p">,</span> <span class="mi">104</span><span class="p">,</span> <span class="mi">105</span><span class="p">,</span> <span class="mi">106</span><span class="p">,</span> <span class="mi">107</span><span class="p">,</span> <span class="mi">108</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">110</span><span class="p">,</span> <span class="mi">111</span><span class="p">,</span> <span class="mi">112</span><span class="p">,</span> <span class="mi">113</span><span class="p">,</span> <span class="mi">114</span><span class="p">,</span> <span class="mi">115</span><span class="p">,</span> <span class="mi">116</span><span class="p">,</span> <span class="mi">117</span><span class="p">,</span> <span class="mi">118</span><span class="p">,</span> <span class="mi">119</span><span class="p">}</span>
<span class="p">(</span><span class="s1">&#39;4eh4&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">)</span> <span class="p">{</span><span class="mi">224</span><span class="p">,</span> <span class="mi">225</span><span class="p">,</span> <span class="mi">226</span><span class="p">,</span> <span class="mi">227</span><span class="p">,</span> <span class="mi">228</span><span class="p">,</span> <span class="mi">229</span><span class="p">,</span> <span class="mi">230</span><span class="p">,</span> <span class="mi">231</span><span class="p">,</span> <span class="mi">232</span><span class="p">,</span> <span class="mi">233</span><span class="p">,</span> <span class="mi">234</span><span class="p">,</span> <span class="mi">235</span><span class="p">,</span> <span class="mi">236</span><span class="p">,</span> <span class="mi">221</span><span class="p">,</span> <span class="mi">222</span><span class="p">,</span> <span class="mi">223</span><span class="p">}</span>
<span class="p">(</span><span class="s1">&#39;4eh9&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">)</span> <span class="p">{</span><span class="mi">224</span><span class="p">,</span> <span class="mi">225</span><span class="p">,</span> <span class="mi">226</span><span class="p">,</span> <span class="mi">227</span><span class="p">,</span> <span class="mi">228</span><span class="p">,</span> <span class="mi">229</span><span class="p">,</span> <span class="mi">230</span><span class="p">,</span> <span class="mi">231</span><span class="p">,</span> <span class="mi">232</span><span class="p">,</span> <span class="mi">233</span><span class="p">,</span> <span class="mi">218</span><span class="p">,</span> <span class="mi">219</span><span class="p">,</span> <span class="mi">220</span><span class="p">,</span> <span class="mi">221</span><span class="p">,</span> <span class="mi">222</span><span class="p">,</span> <span class="mi">223</span><span class="p">}</span>
</pre></div>
</div>
<p>These residue indices can then be visualized on a protein structure
using molecule visualization software such as PyMol. Comparing the same
location in proteins which don’t have this shape-mer can also be
informative.</p>
</div>
</div>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2020, Janani Durairaj, Mehmet Akdel.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.2.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/getting_started.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/TurtleTools/geometricus" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>